/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/data"],(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=7)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var r=n(3);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(4)(!0)).push([e.i,".image-container {\n  display: block;\n  flex: none; }\n\n.full {\n  height: 100%;\n  width: 100%; }\n\n.image-container img {\n  -o-object-fit: contain;\n     object-fit: contain;\n  width: 100%;\n  height: 100%; }\n\n.container {\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: flex-start;\n  /* Other than hidden -> scroll bar ? */\n  overflow: hidden;\n  height: 100%; }\n","",{version:3,sources:["image.css"],names:[],mappings:"AAAA;EACE,cAAc;EACd,UAAU,EAAE;;AAEd;EACE,YAAY;EACZ,WAAW,EAAE;;AAEf;EACE,sBAAmB;KAAnB,mBAAmB;EACnB,WAAW;EACX,YAAY,EAAE;;AAEhB;EACE,aAAa;EACb,mBAAmB;EACnB,2BAA2B;EAC3B,sCAAsC;EACtC,gBAAgB;EAChB,YAAY,EAAE",file:"image.css",sourcesContent:[".image-container {\n  display: block;\n  flex: none; }\n\n.full {\n  height: 100%;\n  width: 100%; }\n\n.image-container img {\n  object-fit: contain;\n  width: 100%;\n  height: 100%; }\n\n.container {\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: flex-start;\n  /* Other than hidden -> scroll bar ? */\n  overflow: hidden;\n  height: 100%; }\n"]}]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,l=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(s," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}var a,l,s;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);r&&i[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},function(e,t,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),l=function(e,t){return t?t.querySelector(e):document.querySelector(e)},s=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=l.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),c=null,u=0,f=[],d=n(6);function p(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(b(r.parts[a],t))}else{var l=[];for(a=0;a<r.parts.length;a++)l.push(b(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:l}}}}function m(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],l={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(l):n.push(r[a]={id:a,parts:[l]})}return n}function h(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),f.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(e.insertAt.before,n);n.insertBefore(t,i)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return y(t,e.attrs),h(e,t),t}function y(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function b(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var a=u++;n=c||(c=g(t)),r=E.bind(null,n,a,!1),i=E.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),h(e,t),t}(t),r=_.bind(null,n,t),i=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(t),r=x.bind(null,n),i=function(){v(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=m(e,t);return p(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(l=o[a.id]).refs--,r.push(l)}e&&p(m(e,t),t);for(i=0;i<r.length;i++){var l;if(0===(l=r[i]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete o[l.id]}}}};var A,w=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function E(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function x(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function _(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=d(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),l=e.href;e.href=URL.createObjectURL(a),l&&URL.revokeObjectURL(l)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t,n){"use strict";n.r(t);var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var l=n(1),s=n(0),c=n.n(s),u=(n(2),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.getFieldIndex=function(e,t){for(var n,r=0;r<t.length;r++)if(t[r].type!==l.FieldType.time&&""===e||e===t[r].name||e===(null===(n=t[r].labels)||void 0===n?void 0:n.name))return r;return-1},t.prototype.getTimeFieldIndex=function(e){for(var t=0;t<e.length;t++)if(e[t].type===l.FieldType.time)return t;return-1},t.prototype.render=function(){var e=this.props,t=e.options,n=e.data;if(!n||0===n.series.length)return console.error("data is empty or null"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"No data found in response."));if(n.error)return console.error("Message : "+n.error.message),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Error. See javascript console for more precision"));if(n.series.length>1){console.error(n.series.length+" timeseries (see series in debug)");for(var r=0;r<n.series.length;r++)console.error("Serie "+r+" : "+n.series[r].name);return c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"There's multiple time series. Use the outer join transform."))}var i=n.series[0].fields[0].values.length,o=this.getFieldIndex(t.icon_field,n.series[0].fields);if(-1===o)return""===t.icon_field?(console.error("Missing non time field from data (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Can't find a non time field for image."))):(console.error("Missing field '"+t.icon_field+"' from data (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Can't find ",t.icon_field," field for image.")));var a=""===t.alt_field?o:this.getFieldIndex(t.alt_field,n.series[0].fields);if(-1===a)return console.error("Missing field '"+t.alt_field+"' from data for alt (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Can't find ",t.alt_field," field for alt."));var s=t.tooltip&&t.tooltip_include_field&&""!==t.tooltip_field?this.getFieldIndex(t.tooltip_field,n.series[0].fields):o;if(-1===s)return console.error("Missing field '"+t.tooltip_field+"' from data for tooltip (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Can't find ",t.tooltip_field," field for tooltip."));var u=t.tooltip&&t.tooltip_include_date?this.getTimeFieldIndex(n.series[0].fields):o;if(-1===u)return console.error("Missing time field from data for tooltip (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"Can't find time field for tooltip."));var f=[];for(r=0;r<i;r++){var d="";t.tooltip&&t.tooltip_include_date&&(d=t.tooltip_date_elapsed?Object(l.dateTimeFormatTimeAgo)(n.series[0].fields[u].values.get(r)):Object(l.dateTimeFormat)(n.series[0].fields[u].values.get(r),{timeZone:"browser"})),t.tooltip&&t.tooltip_include_field&&(""!==d&&(d+=" - "),d+=n.series[0].fields[s].values.get(r)),f.push({icon:n.series[0].fields[o].values.get(r),alt:n.series[0].fields[a].values.get(r),tooltip:d})}var p=void 0===t.baseUrl?"":t.baseUrl;p=this.props.replaceVariables(p);var m=void 0===t.suffix?"":t.suffix;if(m=this.props.replaceVariables(m),!f||0===f.length)return console.error("Serie contains no values (see series in debug)"),c.a.createElement("div",{className:"panel-empty"},c.a.createElement("p",null,"No data found in response."));if(t.singleFill&&1===f.length)return t.tooltip?c.a.createElement("div",{className:"image-container full"},c.a.createElement("img",{src:p+f[0].icon+m,alt:f[0].alt,title:f[0].tooltip})):c.a.createElement("div",{className:"image-container full"},c.a.createElement("img",{src:p+f[0].icon+m,alt:f[0].alt}));var h=Number(this.props.replaceVariables(t.width)),v=Number(this.props.replaceVariables(t.height));return c.a.createElement("div",{className:"container"},f.map((function(e){return t.tooltip?c.a.createElement("img",{src:p+e.icon+m,style:{width:h+"px",height:v+"px",pointerEvents:"auto"},alt:e.alt,title:e.tooltip}):c.a.createElement("img",{src:p+e.icon+m,style:{width:h+"px",height:v+"px"},alt:e.alt})})))},t}(s.PureComponent));function f(e,t){var n,r,i,o,s=[t];if(e&&e.data)try{for(var c=a(e.data),u=c.next();!u.done;u=c.next()){var f=u.value;try{for(var d=(i=void 0,a(f.fields)),p=d.next();!p.done;p=d.next()){var m=p.value,h=Object(l.getFieldDisplayName)(m,f,e.data);s.push({value:h,label:h})}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return s}n.d(t,"plugin",(function(){return d}));var d=new l.PanelPlugin(u).setPanelOptions((function(e){return e.addTextInput({path:"baseUrl",name:"Base URL",description:"First part of the URL",category:["URL"]}).addSelect({path:"icon_field",name:"Icon field",description:"Field value to use in the URL",settings:{allowCustomValue:!1,options:[],getOptions:function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,Promise.resolve(f(e,{value:"",label:"First non time field"}))]}))}))}},defaultValue:"",category:["URL"]}).addTextInput({path:"suffix",name:"Suffix",description:"To append at the end of the URL",category:["URL"]}).addTextInput({path:"width",name:"Image width",description:"Image width in pixel (potentially ignored if 'single fill')",defaultValue:"75",category:["Image options"]}).addTextInput({path:"height",name:"Image height",description:"Image height in pixel (potentially ignored if 'single fill')",defaultValue:"75",category:["Image options"]}).addBooleanSwitch({path:"singleFill",name:"Single fill",description:"If there is a single image, it will try to fill panel",defaultValue:!0,category:["Image options"]}).addSelect({path:"alt_field",name:"Alt field",description:"Field value that is displayed if image doesn't exists",settings:{allowCustomValue:!1,options:[],getOptions:function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,Promise.resolve(f(e,{value:"",label:"Use icon field"}))]}))}))}},defaultValue:"",category:["Image options"]}).addBooleanSwitch({path:"tooltip",name:"Include tooltip",description:"Image have a tooltip",defaultValue:!1,category:["Image tooltip options"]}).addBooleanSwitch({path:"tooltip_include_field",name:"Include field",description:"Include a field value in tooltip text",defaultValue:!0,showIf:function(e){return e.tooltip},category:["Image tooltip options"]}).addSelect({path:"tooltip_field",name:"Tooltip field",description:"Field value, if any, to include in the tooltip text",settings:{allowCustomValue:!1,options:[],getOptions:function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,Promise.resolve(f(e,{value:"",label:"Use icon field"}))]}))}))}},defaultValue:"",showIf:function(e){return e.tooltip&&e.tooltip_include_field},category:["Image tooltip options"]}).addBooleanSwitch({path:"tooltip_include_date",name:"Include date",description:"Include the date, if any, in tooltip text",defaultValue:!1,showIf:function(e){return e.tooltip},category:["Image tooltip options"]}).addBooleanSwitch({path:"tooltip_date_elapsed",name:"As elapsed",description:"Display as elapsed date",defaultValue:!1,showIf:function(e){return e.tooltip&&e.tooltip_include_date},category:["Image tooltip options"]})}))}])}));
//# sourceMappingURL=module.js.map